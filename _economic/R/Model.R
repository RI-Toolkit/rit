var_model <- function() {
    var_names = c("zcp3m_yield", "zcp10y_spread", "home_index", "rental_yield", "GDP", "CPI", "ASX200", "AUD")
    sim_var_names = c(var_names, "mortgage_rate", "unemployment_rate")
    intercept = c(-0.165665068,0.014222835,0.000697426,0.001208242,0.007404573,0.006936114,0.020845829,-0.001948064)
    coef = data.frame(zcp3m_yield = c(0.33992941,0.113784745,2.86568168,-19.6205786,-2.1372348,0.4466213,0.99122306,0.65416550),
                        zcp10y_spread = c(-0.45145476,0.867037435,2.19363658,1.9921148,4.4229589,5.7463705,-0.56233231,1.85265166),
                        home_index = c(-0.00661822,0.000568036,0.72566350,0.0746341,0.3094571,-0.1766833,0.03114352,0.00984050),
                        rental_yield = c(0.00150427,-0.001065600,-0.00245535,0.1967380,-0.0335203,0.0482826,0.00803609,0.00148116),
                        GDP = c(-0.00243469,0.001739440,-0.06584194,0.3091203,-0.0617071,-0.1506179,0.01758549,0.04417218),
                        CPI = c(0.00256898,-0.000754316,0.00615750,-0.1858264,-0.0911666,0.0884468,0.00387475,-0.00201055),
                        ASX200 = c(-0.00167551,0.001251294,-0.32533013,-1.1531345,0.1320861,-1.9311967,0.26973160,0.12588817),
                        AUD = c(-0.02216189,0.003490000,0.26377394,-1.1205875,0.2365210,-0.7783240,-0.01069297,0.24006978),
                        row.names = c("Coeff1", "Coeff2", "Coeff3", "Coeff4", "Coeff5", "Coeff6", "Coeff7", "Coeff8"))
    covres = data.frame(zcp3m_yield = c(0.147782809, -0.1010170150, 2.53209e-04, -2.71426e-04, 6.60361e-04, 4.41163e-04, 0.0043253002, 7.57409e-03),
                        zcp10y_spread = c(-0.101017015, 0.2118572919, -6.23599e-05, -1.20674e-04, -4.37033e-04, -1.44520e-04, -0.0026649796, -4.78746e-03),
                        home_index = c(0.000253209, -0.0000623599, 1.43124e-04, -6.82911e-06, 8.61086e-06, -1.00958e-06, 0.0001237822, 4.30438e-05),
                        rental_yield = c(-0.000271426, -0.0001206736, -6.82911e-06, 1.67679e-05, -3.35037e-08, 2.46972e-06, -0.0000480865, -2.81226e-05),
                        GDP = c(0.000660361, -0.0004370325, 8.61086e-06, -3.35037e-08, 9.90145e-05, 2.00431e-05, 0.0001435020, 7.72833e-06),
                        CPI = c(0.000441163, -0.0001445196, -1.00958e-06, 2.46972e-06, 2.00431e-05, 3.09181e-05, 0.0000535892, 2.50834e-05),
                        ASX200 = c(0.004325300, -0.0026649796, 1.23782e-04, -4.80865e-05, 1.43502e-04, 5.35892e-05, 0.0029571153, 9.07070e-04),
                        AUD = c(0.007574089, -0.0047874552, 4.30438e-05, -2.81226e-05, 7.72833e-06, 2.50834e-05, 0.0009070698, 1.45155e-03),
                        row.names = var_names)
    init_stat_2020q4 = c(0.0288889,0.8658730,0.023819871,0.05030563686,0.031314173,0.008569033,0.060051552,-0.004329011)
    init_stat_2021q1 = c(-0.00435484,1.42258065,0.0502366847,0.049849918699,0.0187665113,0.0059549304,0.0592502694,0.0372581679)
    init_orig = c(-0.00435484, 1.418226, 157.5923, 0.04984992, 501788, 117.9, 6766.84, 63.8000)
    lambda_0 = matrix(c(-0.0300869, -0.012627, -0.0179271, 0.0245439, -0.0141266, -0.013161, -0.0339329, -0.0298033), nrow = 8)
    lambda_1 = matrix(c(-0.00676676,0.00190172,0.00375620,0.006151668,0.00116080,0.00081834,0.00363284,0.00510658,
                        0.00874009,0.00329734,0.00514494,0.007689653,0.00494228,0.01165728,0.00777616,0.01117729,
                        -0.00399927,0.00188649,0.00345333, -0.005177457,0.00722763, -0.00883047,0.00290525,0.01205820,
                        0.01598942,0.01589751,0.01790125,0.011338143,0.00546149,0.01048769,0.00908834,0.01011179,
                        -0.00319565,0.00488528,0.00568038, -0.001230780,0.00773241,0.00787398,0.00216374, -0.01536454,
                        -0.00164112,0.01035217,0.00172788,0.000642188, -0.00192222,0.00954098,0.00139571,0.01200787,
                        -0.02448375, -0.01474440, -0.00439583,0.049782154, -0.00573123, -0.00386753, -0.00522005,0.01668418,
                        -0.03278908, -0.00688552,0.00839877,0.002207839, -0.00159956, -0.00580826,0.00300228,0.01805823), nrow = 8, byrow = T)
    init_lambdat = matrix(c(-0.0291320, -0.0108994, -0.0172803,  0.027314,1 -0.0140852, -0.0123440, -0.0316990, -0.0285817), nrow = 8)
    init_st = 0.997953
    mortgage_rate = 0.02825
    unemployment_rate = 0.04956

    model = list(intercept = intercept,
                 coef = coef,
                 covres = covres,
                 init_stat_2020q4 = init_stat_2020q4,
                 init_stat_2021q1 = init_stat_2021q1,
                 init_orig = init_orig,
                 lambda_0 = lambda_0,
                 lambda_1 = lambda_1,
                 init_lambdat = init_lambdat,
                 init_st = init_st,
                 mortgage_rate = mortgage_rate,
                 unemployment_rate = unemployment_rate)

    return(model)
}

afns_model <- function(model, type, frequency) {

    if (model == "interest_rate") {
        init_zcp = c(-0.0000666667,  0.0003857143,  0.0005095238,  0.0003571429,  0.0001000000, -0.0001000000, -0.0001571429, -0.0000476190,  0.0002238095,  0.0006333333,  0.0011523810,  0.0017523810,  0.0024047619,  0.0031000000, 0.0038142857,  0.0045238095,  0.0052428571,  0.0059571429,  0.0066380952,  0.0073000000,  0.0079523810, 0.0085809524,  0.0091952381,  0.0097761905,  0.0103476190,  0.0109047619,  0.0114190476,  0.0119380952, 0.0124333333,  0.0129095238,  0.0133714286,  0.0138142857,  0.0142476190,  0.0146666667,  0.0150857143, 0.0154714286,  0.0158523810,  0.0162238095,  0.0165952381,  0.0169333333)
        mat_qtrs = paste(paste("maturity",1:40,sep = "_"),"qtrs",sep = "")
        num_xt = 3
        num_zcp = 40
        mu0 = rep(0,num_xt)
        
        if (type == "independent") {
            
            ###########################################
            # independent-factor term-structure model #
            ###########################################
            
            ########################
            # estimated parameters #
            ########################
            
            if (frequency == "year") {
                h = 1
                Q_est = diag(c(0.0000503249, 0.0000615258, 0.000109023))
                EK_est = diag(c(0.199374, 0.5687, 0.453543))
            } else if (frequency == "quarter") {
                h = 1/4
                Q_est = diag(c(0.0000147503, 0.0000259462, 0.0000405344))
                EK_est = diag(c(0.054073, 0.189608, 0.140217))
            } else {
                h = 1/12
                Q_est = diag(c(5.10007e-06, 9.88515e-06, 0.0000148928))
                EK_est = diag(c(0.018359, 0.06768, 0.049111))
            }

            init_xt = as.numeric(c(0.0431174, -0.0453477, -0.0422812))
            KP_est = diag(c(0.222361,0.840951,0.6043))
            theta_est = matrix(c(0.0404048, -0.0247579, 0.000506779), nrow = num_xt, ncol = 1, byrow = T)
            lambda_est = 0.323143
            B_fitted = matrix(c(1, 0.960673, 0.0382820,
                                1, 0.923395, 0.0725893,
                                1, 0.888045, 0.1032697,
                                1, 0.854512, 0.1306420,
                                1, 0.822690, 0.1549988,
                                1, 0.792481, 0.1766080,
                                1, 0.763791, 0.1957154,
                                1, 0.736534, 0.2125460,
                                1, 0.710628, 0.2273062,
                                1, 0.685997, 0.2401849,
                                1, 0.662568, 0.2513549,
                                1, 0.640274, 0.2609748,
                                1, 0.619052, 0.2691893,
                                1, 0.598841, 0.2761311,
                                1, 0.579586, 0.2819214,
                                1, 0.561235, 0.2866711,
                                1, 0.543736, 0.2904815,
                                1, 0.527045, 0.2934451,
                                1, 0.511117, 0.2956465,
                                1, 0.495911, 0.2971629,
                                1, 0.481388, 0.2980647,
                                1, 0.467512, 0.2984161,
                                1, 0.454249, 0.2982757,
                                1, 0.441565, 0.2976968,
                                1, 0.429431, 0.2967281,
                                1, 0.417817, 0.2954136,
                                1, 0.406698, 0.2937937,
                                1, 0.396047, 0.2919048,
                                1, 0.385840, 0.2897802,
                                1, 0.376054, 0.2874500,
                                1, 0.366669, 0.2849415,
                                1, 0.357665, 0.2822794,
                                1, 0.349021, 0.2794862,
                                1, 0.340720, 0.2765821,
                                1, 0.332746, 0.2735853,
                                1, 0.325081, 0.2705125,
                                1, 0.317712, 0.2673784,
                                1, 0.310624, 0.2641964,
                                1, 0.303803, 0.2609785,
                                1, 0.297236, 0.2577355), nrow = num_zcp, byrow = T)
            A_fitted = c(1.89811e-06, 7.32411e-06, 1.59407e-05, 2.74808e-05, 4.17307e-05, 5.85172e-05, 7.76972e-05, 9.91507e-05, 1.22775e-04, 1.48478e-04, 1.76182e-04, 2.05811e-04, 2.37298e-04, 2.70581e-04,
                            3.05599e-04, 3.42296e-04, 3.80619e-04, 4.20516e-04, 4.61940e-04, 5.04845e-04, 5.49187e-04, 5.94924e-04, 6.42020e-04, 6.90436e-04, 7.40140e-04, 7.91101e-04, 8.43288e-04, 8.96676e-04,
                            9.51240e-04, 1.00696e-03, 1.06381e-03, 1.12177e-03, 1.18084e-03, 1.24099e-03, 1.30221e-03, 1.36450e-03, 1.42783e-03, 1.49221e-03, 1.55763e-03, 1.62408e-03)
            
        } else {

            ##########################################
            # correlated-factor term-structure model #
            ##########################################
            
            ########################
            # estimated parameters #
            ########################
            
          if (frequency == "year") {
            h = 1
            Q_est = matrix(c(0.001560471, -0.000302385, -0.002268109,
                             -0.000302385,  0.000340397,  0.000193958,
                             -0.002268109,  0.000193958,  0.004222395), nrow = num_xt, byrow = T)
            EK_est = matrix(c(0.375241, 0.072229, 0.122981,
                              0.158519, 0.235903, 0.031313,
                              0.134443, 0.066517, 0.167140), nrow = num_xt, byrow = T)
          } else if (frequency == "quarter") {
            h = 1/4
            Q_est = matrix(c(0.000281342, -0.000160715, -0.000549391,
                             -0.000160715,  0.000125564,  0.000243026,
                             -0.000549391,  0.000243026,  0.001554524), nrow = num_xt, byrow = T)
            EK_est = matrix(c(0.116456, 0.025470, 0.040066,
                              0.053644, 0.067540, 0.012588,
                              0.045124, 0.021543, 0.047749), nrow = num_xt, byrow = T)
          } else {
            h = 1/12
            Q_est = matrix(c(0.0000722608, -0.0000614619, -0.000162393,
                             -0.0000614619,  0.0000544916,  0.000124538,
                             -0.0001623930,  0.0001245380,  0.000603918), nrow = num_xt, byrow = T)
            EK_est = matrix(c(0.040855, 0.009172, 0.014196,
                              0.019159, 0.023254, 0.004643,
                              0.016089, 0.007623, 0.016442), nrow = num_xt, byrow = T)
          }
          
          init_xt = c(0.1110450, -0.1183216, -0.0499631)
          KP_est = matrix(c(0.503160, 0.114419, 0.1756810,
                            0.238044, 0.283698, 0.0585722,
                            0.199730, 0.094278, 0.2006165), nrow = num_xt, byrow = T)
          theta_est = matrix(c(0.1357986,-0.0568641,-0.1156273), nrow = num_xt, ncol = 1, byrow = T)
          lambda_est = 0.0934927
          B_fitted = matrix(c(1, 0.988404, 0.0115061,
                              1, 0.976987, 0.0226574,
                              1, 0.965746, 0.0334631,
                              1, 0.954677, 0.0439324,
                              1, 0.943778, 0.0540738,
                              1, 0.933047, 0.0638961,
                              1, 0.922479, 0.0734075,
                              1, 0.912072, 0.0826162,
                              1, 0.901824, 0.0915301,
                              1, 0.891731, 0.1001570,
                              1, 0.881791, 0.1085044,
                              1, 0.872002, 0.1165797,
                              1, 0.862361, 0.1243901,
                              1, 0.852864, 0.1319425,
                              1, 0.843511, 0.1392438,
                              1, 0.834298, 0.1463008,
                              1, 0.825223, 0.1531197,
                              1, 0.816283, 0.1597071,
                              1, 0.807477, 0.1660691,
                              1, 0.798801, 0.1722116,
                              1, 0.790255, 0.1781406,
                              1, 0.781835, 0.1838618,
                              1, 0.773539, 0.1893808,
                              1, 0.765366, 0.1947030,
                              1, 0.757313, 0.1998337,
                              1, 0.749379, 0.2047781,
                              1, 0.741560, 0.2095413,
                              1, 0.733857, 0.2141281,
                              1, 0.726265, 0.2185434,
                              1, 0.718784, 0.2227918,
                              1, 0.711412, 0.2268779,
                              1, 0.704146, 0.2308062,
                              1, 0.696986, 0.2345809,
                              1, 0.689928, 0.2382063,
                              1, 0.682973, 0.2416865,
                              1, 0.676117, 0.2450255,
                              1, 0.669360, 0.2482272,
                              1, 0.662699, 0.2512955,
                              1, 0.656133, 0.2542340,
                              1, 0.649661, 0.2570463), nrow = num_zcp, byrow = T)
          A_fitted = c(6.66527e-08, 4.07651e-07, 1.29267e-06, 3.05901e-06, 6.10032e-06, 1.08562e-05, 1.78031e-05, 2.74458e-05, 4.03099e-05, 5.69352e-05, 7.78695e-05, 1.03663e-04, 1.34865e-04, 1.72018e-04, 2.15654e-04, 2.66292e-04, 3.24437e-04, 3.90573e-04,
                       4.65166e-04, 5.48659e-04, 6.41473e-04, 7.44003e-04, 8.56621e-04, 9.79669e-04, 1.11347e-03, 1.25831e-03, 1.41446e-03, 1.58215e-03, 1.76161e-03, 1.95300e-03, 2.15651e-03, 2.37226e-03, 2.60035e-03, 2.84089e-03, 3.09394e-03, 3.35953e-03,
                       3.63768e-03, 3.92840e-03, 4.23166e-03, 4.54742e-03)
            
        }
    } else {
        
        init_zcp = c(-0.0000666667,  0.0003857143,  0.0005095238,  0.0003571429,  0.0001000000, -0.0001000000, -0.0001571429, -0.0000476190,  0.0002238095,  0.0006333333,  0.0011523810,  0.0017523810,  0.0024047619,  0.0031000000, 0.0038142857,  0.0045238095,  0.0052428571,  0.0059571429,  0.0066380952,  0.0073000000,  0.0079523810, 0.0085809524,  0.0091952381,  0.0097761905,  0.0103476190,  0.0109047619,  0.0114190476,  0.0119380952, 0.0124333333,  0.0129095238,  0.0133714286,  0.0138142857,  0.0142476190,  0.0146666667,  0.0150857143, 0.0154714286,  0.0158523810,  0.0162238095,  0.0165952381,  0.0169333333, 5.1364719541,  8.8631940360)
        mat_qtrs = c(paste(paste("maturity",1:40,sep = "_"),"qtrs",sep = ""), "house_index", "stock_price")
        num_xt = 5
        num_zcp = 42
        mu0 = rep(0,num_xt)
        
        if (type == "independent") {

            #####################################################################
            # independent-factor term-structure, house index, stock price model #
            #####################################################################

            ########################
            # estimated parameters #
            ########################

            if (frequency == "year") {
                h = 1
                Q_est = matrix(c(0.0000784826, 0.000000000,  0.00000000, 0.000101867,  0.00113357,
                                 0.0000000000, 0.000491152,  0.00000000, 0.000478215,  0.00037560,
                                 0.0000000000, 0.000000000,  1.41137198, 0.002006712, -0.01332913,
                                 0.0001018673, 0.000478215,  0.00200671, 0.001336828,  0.00170760,
                                 0.0011335720, 0.000375600, -0.01332913, 0.001707597,  0.02036543), nrow = num_xt, byrow = T)
                EK_est = matrix(c(0.991572, 0.000000, 0.000000,    0,    0,
                                  0.000000, 0.936339, 0.000000,    0,    0,
                                  0.000000, 0.000000, 0.776069,    0,    0,
                                  0.499264, 0.480586, 0.000000,    1,    0,
                                  0.499264, 0.480586, 0.000000,    0,    1), nrow = num_xt, byrow = T)
            } else if (frequency == "quarter") {
                h = 1/4
                Q_est = matrix(c(0.0000198691, 0.0000000000,  0.000000000, 0.0000182601,  0.0002778167,
                                 0.0000000000, 0.0001352049,  0.000000000, 0.0000782078,  0.0000512697,
                                 0.0000000000, 0.0000000000,  0.501592438, 0.0006045877, -0.0040158366,
                                 0.0000182601, 0.0000782078,  0.000604588, 0.0002329444,  0.0002387445,
                                 0.0002778167, 0.0000512697, -0.004015837, 0.0002387445,  0.0048163113), nrow = num_xt, byrow = T)
                EK_est = matrix(c(0.2494601, 0.0000000, 0.000000, 0.00, 0.00,
                                  0.0000000, 0.2458040, 0.000000, 0.00, 0.00,
                                  0.0000000, 0.0000000, 0.233816, 0.00, 0.00,
                                  0.0319857, 0.0316762, 0.000000, 0.25, 0.00,
                                  0.0319857, 0.0316762, 0.000000, 0.00, 0.25), nrow = num_xt, byrow = T)
            } else {
                h = 1/12
                Q_est = matrix(c(6.64143e-06, 0.0000000000,  0.000000000, 5.54977e-06,  0.0000921889,
                                 0.00000e+00, 0.0000460542,  0.000000000, 2.26266e-05,  0.0000135492,
                                 0.00000e+00, 0.0000000000,  0.181906980, 2.10343e-04, -0.0013971554,
                                 5.54977e-06, 0.0000226266,  0.000210343, 7.24553e-05,  0.0000680075,
                                 9.21889e-05, 0.0000135492, -0.001397155, 6.80075e-05,  0.0015874820), nrow = num_xt, byrow = T)
                EK_est = matrix(c(0.08326888, 0.00000000, 0.0000000, 0.0000000, 0.0000000,
                                  0.00000000, 0.08282935, 0.0000000, 0.0000000, 0.0000000,
                                  0.00000000, 0.00000000, 0.0813474, 0.0000000, 0.0000000,
                                  0.00381757, 0.00380474, 0.0000000, 0.0833333, 0.0000000,
                                  0.00381757, 0.00380474, 0.0000000, 0.0000000, 0.0833333), nrow = num_xt, byrow = T)
            }

            init_xt = c(3.68473,  -3.68963,   1.60172,   5.13647,   8.86319)
            KP_est = matrix(c(0.0168809,  0.000000, 0.000000,    0,    0,
                              0.0000000,  0.132465, 0.000000,    0,    0,
                              0.0000000,  0.000000, 0.528005,    0,    0,
                             -1.0000000, -1.000000, 0.000000,    0,    0,
                             -1.0000000, -1.000000, 0.000000,    0,    0), nrow = num_xt, byrow = T)
            theta_est = matrix(c(0.06288723,-0.48560096,0.20092702, 0.00526758,0.04260104), nrow = num_xt, ncol = 1, byrow = T)
            lambda_est = 0.00120714
            B_fitted = matrix(c(1, 0.999849, 0.000150862,    0,    0,
                                1, 0.999698, 0.000301664,    0,    0,
                                1, 0.999547, 0.000452405,    0,    0,
                                1, 0.999397, 0.000603085,    0,    0,
                                1, 0.999246, 0.000753705,    0,    0,
                                1, 0.999095, 0.000904264,    0,    0,
                                1, 0.998944, 0.001054763,    0,    0,
                                1, 0.998794, 0.001205201,    0,    0,
                                1, 0.998643, 0.001355578,    0,    0,
                                1, 0.998493, 0.001505895,    0,    0,
                                1, 0.998342, 0.001656151,    0,    0,
                                1, 0.998191, 0.001806347,    0,    0,
                                1, 0.998041, 0.001956482,    0,    0,
                                1, 0.997890, 0.002106557,    0,    0,
                                1, 0.997740, 0.002256572,    0,    0,
                                1, 0.997590, 0.002406526,    0,    0,
                                1, 0.997439, 0.002556420,    0,    0,
                                1, 0.997289, 0.002706253,    0,    0,
                                1, 0.997139, 0.002856026,    0,    0,
                                1, 0.996988, 0.003005739,    0,    0,
                                1, 0.996838, 0.003155391,    0,    0,
                                1, 0.996688, 0.003304983,    0,    0,
                                1, 0.996537, 0.003454515,    0,    0,
                                1, 0.996387, 0.003603986,    0,    0,
                                1, 0.996237, 0.003753398,    0,    0,
                                1, 0.996087, 0.003902749,    0,    0,
                                1, 0.995937, 0.004052040,    0,    0,
                                1, 0.995787, 0.004201271,    0,    0,
                                1, 0.995637, 0.004350441,    0,    0,
                                1, 0.995487, 0.004499552,    0,    0,
                                1, 0.995337, 0.004648602,    0,    0,
                                1, 0.995187, 0.004797593,    0,    0,
                                1, 0.995037, 0.004946523,    0,    0,
                                1, 0.994887, 0.005095393,    0,    0,
                                1, 0.994737, 0.005244203,    0,    0,
                                1, 0.994587, 0.005392954,    0,    0,
                                1, 0.994438, 0.005541644,    0,    0,
                                1, 0.994288, 0.005690274,    0,    0,
                                1, 0.994138, 0.005838844,    0,    0,
                                1, 0.993989, 0.005987355,    0,    0,
                                0, 0.000000, 0.000000000,    1,    0,
                                0, 0.000000, 0.000000000,    0,    1), nrow = num_zcp, ncol = num_xt, byrow = T)
            A_fitted = c(6.18299e-06, 2.64787e-05, 5.99891e-05, 1.06635e-04, 1.66589e-04, 2.39909e-04, 3.26638e-04, 4.26840e-04, 5.40520e-04, 6.67749e-04, 8.08682e-04, 9.63254e-04, 1.13166e-03,
                         1.31388e-03, 1.51011e-03, 1.72040e-03, 1.94486e-03, 2.18365e-03, 2.43688e-03, 2.70465e-03, 2.98712e-03, 3.28446e-03, 3.59684e-03, 3.92437e-03, 4.26728e-03, 4.62566e-03,
                         4.99980e-03, 5.38987e-03, 5.79602e-03, 6.21852e-03, 6.65755e-03, 7.11335e-03, 7.58616e-03, 8.07620e-03, 8.58374e-03, 9.10902e-03, 9.65227e-03, 1.02138e-02, 1.07939e-02,
                         1.13929e-02, 0.00000e+00, 0.00000e+00)

        } else {

            ####################################################################
            # correlated-factor term-structure, house index, stock price model #
            ####################################################################

            ######################## 
            # estimated parameters #
            ########################

            if (frequency == "year") {
                h = 1
                Q_est = matrix(c(0.0439188, -0.0445876,  0.0792384, -0.289422, -0.537820,
                                -0.0445876,  0.0557370, -0.0950323,  0.372137,  0.692219,
                                 0.0792384, -0.0950323,  0.1639257, -0.637659, -1.186238,
                                -0.2894215,  0.3721371, -0.6376587,  2.728586,  5.128453,
                                -0.5378203,  0.6922187, -1.1862379,  5.128453,  9.684423), nrow = num_xt, byrow = T)
                EK_est = matrix(c(1.003402, -0.502983,  0.2586809,    0,    0,
                                 -0.517533,  0.835973, -0.1523428,    0,    0,
                                  0.742412, -1.064132,  0.5649364,    0,    0,
                                  0.296436,  0.261156,  0.0465919,    1,    0,
                                  0.296436,  0.261156,  0.0465919,    0,    1), nrow = num_xt, byrow = T)
            } else if (frequency == "quarter") {
                h = 1/4
                Q_est = matrix(c(0.000589567, -0.00205536,  0.00321359, -0.0161024, -0.0302425,
                                -0.002055361,  0.01183104, -0.01678961,  0.0842664,  0.1579397,
                                 0.003213586, -0.01678961,  0.02436066, -0.1232473, -0.2312984,
                                -0.016102352,  0.08426643, -0.12324733,  0.6618257,  1.2530534,
                                -0.030242504,  0.15793975, -0.23129838,  1.2530534,  2.3833067), nrow = num_xt, byrow = T)
                EK_est = matrix(c(0.2345443, -0.0236329,  0.02437293, 0.00, 0.00,
                                 -0.0397087,  0.2210959, -0.00863209, 0.00, 0.00,
                                  0.0400214, -0.1111156,  0.19036550, 0.00, 0.00,
                                  0.0271565,  0.0275578,  0.00145819, 0.25, 0.00,
                                  0.0271565,  0.0275578,  0.00145819, 0.00, 0.25), nrow = num_xt, byrow = T)
            } else {
                h = 1/12
                Q_est = matrix(c(0.0000152506, -0.000134147,  0.000200938, -0.00117935, -0.00225455,
                                -0.0001341474,  0.004335240, -0.005449960,  0.02913339,  0.05484094,
                                 0.0002009379, -0.005449960,  0.007007671, -0.03797392, -0.07162678,
                                -0.0011793519,  0.029133389, -0.037973924,  0.21675164,  0.41214271,
                                -0.0022545514,  0.054840940, -0.071626782,  0.41214271,  0.78720897), nrow = num_xt, byrow = T)
                EK_est = matrix(c(0.08103396, -0.00233073,  0.0033539500, 0.0000000, 0.0000000,
                                 -0.00511318,  0.07927359, -0.0009659750, 0.0000000, 0.0000000,
                                  0.00434667, -0.01571144,  0.0748433917, 0.0000000, 0.0000000,
                                  0.00359974,  0.00363292,  0.0000720417, 0.0833333, 0.0000000,
                                  0.00359974,  0.00363292,  0.0000720417, 0.0000000, 0.0833333), nrow = num_xt, byrow = T)
            }

            init_xt = c(0.0226760, -0.0124293, -0.0583605,  5.1365353,  8.8602453)
            KP_est = matrix(c(0.665756,  0.520699, -0.955178, 0, 0,
                              1.401675,  1.153088,  0.240643, 0, 0,
                              -1.057659,  4.539859,  2.446048, 0, 0,
                              -1.000000, -1.000000,  0.000000, 0, 0,
                              -1.000000, -1.000000,  0.000000, 0, 0), nrow = 5, byrow = T)
            theta_est = matrix(c(0.0476599,0.4011195,-0.6895536,0.8074529,0.2549644), nrow = 5, ncol = 1, byrow = T)
            lambda_est = 1.20156 
            B_fitted = matrix(c(1, 0.8637796, 0.1232496,    0,    0,
                                1, 0.7517171, 0.2033325,    0,    0,
                                1, 0.6590393, 0.2529439,    0,    0,
                                1, 0.5819737, 0.2812479,    0,    0,
                                1, 0.5175311, 0.2948346,    0,    0,
                                1, 0.4633360, 0.2984226,    0,    0,
                                1, 0.4174950, 0.2953717,    0,    0,
                                1, 0.3784941, 0.2880581,    0,    0,
                                1, 0.3451188, 0.2781482,    0,    0,
                                1, 0.3163917, 0.2667980,    0,    0,
                                1, 0.2915232, 0.2547976,    0,    0,
                                1, 0.2698732, 0.2426767,    0,    0,
                                1, 0.2509207, 0.2307810,    0,    0,
                                1, 0.2342404, 0.2193263,    0,    0,
                                1, 0.2194832, 0.2084389,    0,    0,
                                1, 0.2063618, 0.1981831,    0,    0,
                                1, 0.1946384, 0.1885819,    0,    0,
                                1, 0.1841158, 0.1796307,    0,    0,
                                1, 0.1746294, 0.1713081,    0,    0,
                                1, 0.1660414, 0.1635818,    0,    0,
                                1, 0.1582358, 0.1564144,    0,    0,
                                1, 0.1511148, 0.1497660,    0,    0,
                                1, 0.1445952, 0.1435964,    0,    0,
                                1, 0.1386064, 0.1378667,    0,    0,
                                1, 0.1330877, 0.1325399,    0,    0,
                                1, 0.1279871, 0.1275815,    0,    0,
                                1, 0.1232598, 0.1229595,    0,    0,
                                1, 0.1188670, 0.1186445,    0,    0,
                                1, 0.1147747, 0.1146100,    0,    0,
                                1, 0.1109536, 0.1108317,    0,    0,
                                1, 0.1073779, 0.1072876,    0,    0,
                                1, 0.1040248, 0.1039579,    0,    0,
                                1, 0.1008743, 0.1008247,    0,    0,
                                1, 0.0979086, 0.0978719,    0,    0,
                                1, 0.0951121, 0.0950850,    0,    0,
                                1, 0.0924708, 0.0924507,    0,    0,
                                1, 0.0899720, 0.0899572,    0,    0,
                                1, 0.0876047, 0.0875937,    0,    0,
                                1, 0.0853587, 0.0853505,    0,    0,
                                1, 0.0832249, 0.0832188,    0,    0,
                                0, 0.0000000, 0.0000000,    1,    0,
                                0, 0.0000000, 0.0000000,    0,    1), nrow = num_zcp, ncol = num_xt, byrow = T)
            A_fitted = c(0.000406733, 0.001053666, 0.001566975, 0.001883629, 0.002040083, 0.002090638, 0.002080732, 0.002041733, 0.001992927, 0.001945050, 0.001903406, 0.001870133, 0.001845666,
                         0.001829628, 0.001821327, 0.001820014, 0.001825000, 0.001835702, 0.001851645, 0.001872454, 0.001897834, 0.001927552, 0.001961424, 0.001999303, 0.002041069, 0.002086621,
                         0.002135876, 0.002188758, 0.002245205, 0.002305158, 0.002368567, 0.002435385, 0.002505571, 0.002579085, 0.002655894, 0.002735964, 0.002819267, 0.002905775, 0.002995464,
                         0.003088311, 0.000000000, 0.000000000)
        }
    }

    model = list(init_zcp = init_zcp,
                 mat_qtrs = mat_qtrs,
                 num_xt = num_xt,
                 num_zcp = num_zcp,
                 mu0 = mu0,
                 h = h,
                 Q_est = Q_est,
                 EK_est = EK_est,
                 init_xt = init_xt,
                 KP_est = KP_est,
                 theta_est = theta_est,
                 lambda_est = lambda_est,
                 B_fitted = B_fitted,
                 A_fitted = A_fitted)

    return(model)
}